var catgame;!function(t){var e=function(e){function i(){e.call(this),this.isWin=0,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(i,e);var s=(__define,i),a=s.prototype;return a.onAddToStage=function(t){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.createGameScene()},a.createGameScene=function(){this.stageW=this.stage.stageWidth,this.stageH=this.stage.stageHeight,this.map=new t.Map,this.map.init(),this.map.x=35,this.map.y=this.stageH-460,this.addChild(this.map),this.cat=new t.Cat,this.map.addEventListener("nodeClick",this.onNodeClick,this),this.map.addEventListener("weizhu",this.onWeiZhu,this),this.cat.addEventListener("catRun",this.onCatRun,this),this.btnStart=t.createBitmapByName("btn_start_png"),this.btnStart.x=(this.stageW-this.btnStart.width)/2,this.btnStart.y=(this.stageH-this.btnStart.height)/2,this.btnStart.touchEnabled=!0,this.btnStart.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gameStart,this),this.addChild(this.btnStart),this.morebtn=t.createBitmapByName("more_png"),this.morebtn.x=(this.stageW-this.morebtn.width)/2,this.morebtn.y=this.stageH-this.morebtn.height,this.morebtn.touchEnabled=!0,this.morebtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.doMore,this),this.scorePanel=new t.ScorePanel,this.successPanel=new t.SuccessPanel,this.successPanel.addEventListener("shareEvent",this.doShare,this),this.successPanel.addEventListener("replayEvent",this.doRestart,this),this.failPanel=new t.FailPanel,this.failPanel.addEventListener("shareEvent",this.doShare,this),this.failPanel.addEventListener("replayEvent",this.doRestart,this)},a.onWeiZhu=function(t){this.cat.weizhu()},a.doShare=function(t){},a.doRestart=function(t){this.gameStart(null)},a.doMore=function(t){},a.gameStart=function(t){this.map.init(),this.cat.init(),this.cat.node=this.map.getNode([4,4]);var e=this.map.coverPos2Point([4,4]);this.cat.x=e[0],this.cat.y=e[1]+10,this.addChild(this.cat),this.btnStart.parent&&this.removeChild(this.btnStart),this.successPanel.parent&&this.removeChild(this.successPanel),this.failPanel.parent&&this.removeChild(this.failPanel),this.morebtn.parent&&this.removeChild(this.morebtn),this.map.unlock(),this.isWin=0},a.onNodeClick=function(t){if(this.map.isExit(this.cat.node))return void this.showResult(!1);this.map.lock();var e=this.map.findPath(this.cat.node);if(e.length){var i=e[0],s=this.map.coverPos2Point(i);this.cat.node=this.map.getNode(i),this.cat.run(s)}else this.showResult(!0)},a.onCatRun=function(t){this.map.unlock()},a.showResult=function(t){t?(this.successPanel.x=(this.stageW-this.successPanel.width)/2,this.successPanel.y=(this.stageH-this.successPanel.height-this.morebtn.height)/2,this.successPanel.score(this.map.tap),this.addChild(this.successPanel),this.isWin=1):(this.failPanel.x=(this.stageW-this.failPanel.width)/2,this.failPanel.y=(this.stageH-this.failPanel.height-this.morebtn.height)/2,this.successPanel.score(this.map.tap),this.addChild(this.failPanel),this.isWin=2),this.addChild(this.morebtn)},i}(egret.DisplayObjectContainer);t.GameContainer=e,egret.registerClass(e,"catgame.GameContainer")}(catgame||(catgame={}));var LoadingUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e),s=i.prototype;return s.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},s.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.onAddToStage=function(t){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},s.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},s.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},s.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},s.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},s.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},s.createGameScene=function(){var t=catgame.createBitmapByName("bg_jpg");this.addChild(t);var e=this.stage.stageWidth,i=this.stage.stageHeight;t.width=e,t.height=i;var s=catgame.createBitmapByName("text_png");s.x=(e-s.width)/2,s.y=i-30,this.addChild(s);var a=new catgame.GameContainer;this.addChild(a)},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var catgame;!function(t){function e(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e}function i(t){var e=RES.getRes(t+"_json"),i=RES.getRes(t+"_png"),s=new egret.MovieClipDataFactory(e,i),a=new egret.MovieClip(s.generateMovieClipData(t));return a}t.createBitmapByName=e,t.createMovieclip=i}(catgame||(catgame={}));var catgame;!function(t){var e=function(e){function i(){e.call(this),this.map=[],this.mapsize=9,this.playTurn=!0,this.block=.2,this.tap=0,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(i,e);var s=(__define,i),a=s.prototype;return a.onAddToStage=function(t){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)},a.init=function(){for(;this.numChildren;)this.removeChildAt(0);this.map=[],this.createMap(),this.tap=0},a.createMap=function(){for(var e,i=0;i<this.mapsize;i++){this.map[i]=[];for(var s=0;s<this.mapsize;s++){e=new t.Node(i,s),e.x=48*i+s%2*24,e.y=44*s,this.map[i][s]=e,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onNodeClick,this),this.addChild(e);var a=(this.mapsize-1)/2;i!=a&&s!=a&&Math.random()<this.block&&(e.doFillPot(),e.touchEnabled=!1)}}},a.lock=function(){this.playTurn=!1},a.unlock=function(){this.playTurn=!0},a.getNode=function(t){return this.map[t[0]][t[1]]},a.onNodeClick=function(t){if(this.playTurn){this.tap=this.tap+1;var e=t.target;e.doFillPot(),e.touchEnabled=!1,e.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onNodeClick,this),this.dispatchEventWith("nodeClick")}},a.showRound=function(t){for(var e,i=t.getPos(),s=this.getRound(i),a=s.length,n=0;n<this.mapsize;n++)for(var h=0;h<this.mapsize;h++)n==i[0]&&h==i[1]||(e=this.map[n][h],e.clean());for(n=0;a>n;n++){var r=s[n];e=this.map[r[0]][r[1]],e.doFillPot()}},a.coverPos2Point=function(t){return[this.x+48*t[0]+t[1]%2*24,this.y+44*t[1]]},a.getRound=function(t){var e,i=t[0],s=t[1],a=[];e=s%2==0?[[i-1,s-1],[i-1,s],[i-1,s+1],[i,s+1],[i+1,s],[i,s-1]]:[[i,s-1],[i-1,s],[i,s+1],[i+1,s+1],[i+1,s],[i+1,s-1]];for(var n=0;6>n;n++){var h=e[n];h[0]>=0&&h[1]>=0&&h[0]<this.mapsize&&h[1]<this.mapsize&&a.push(h)}return a},a.findPath=function(t){for(var e,i=0;i<this.mapsize;i++)for(var s=0;s<this.mapsize;s++)e=this.map[i][s],e.clean();e=this.findNode(t);var a=[];if(e)for(;e.prenode;)a.push(e.getPos()),e=e.prenode;else console.log("已经被困随便走一步"),this.dispatchEventWith("weizhu"),a=this.getNear(t);return a.reverse()},a.randomSort=function(t,e){return Math.random()>.5?1:-1},a.findNode=function(t){for(var e,i,s,a=[t],n=[t],h=!0,r=0,o=0,d=0,l=0;h;){if(o=n.length,0==o)return h=!1,null;var c=[];for(r=0;o>r;r++){for(i=n.shift(),e=this.getRound(i.getPos()),l=e.length,d=0;l>d;d++){var g=e[d];if(s=this.map[g[0]][g[1]],s.isFill())a.push(s);else if(!(a.indexOf(s)>-1||n.indexOf(s)>-1)){if(s.prenode=i,this.isExit(s))return s;c.push(s)}}a.push(i)}n=c}},a.getNear=function(t){for(var e=t.getPos(),i=this.getRound(e),s=i.length,a=0;s>a;a++)if(!this.getNode(i[a]).isFill())return[i[a]];return[]},a.isExit=function(t){var e=t.getPos();return 0==e[0]||0==e[1]||e[0]==this.mapsize-1||e[1]==this.mapsize-1?!0:!1},i}(egret.DisplayObjectContainer);t.Map=e,egret.registerClass(e,"catgame.Map")}(catgame||(catgame={}));var catgame;!function(t){var e=function(t){function e(e,i){t.call(this);var s=RES.getRes("pot1_png");this.posx=e,this.posy=i,t.call(this,s),this.anchorOffsetX=this.x+.5*this.width,this.anchorOffsetY=this.y+.5*this.height,this.fill=!1}__extends(e,t);var i=(__define,e),s=i.prototype;return s.doFillPot=function(){this.texture=RES.getRes("pot2_png"),this.fill=!0},s.clean=function(){this.prenode=null},s.getPos=function(){return[this.posx,this.posy]},s.isFill=function(){return this.fill},e}(egret.Bitmap);t.Node=e,egret.registerClass(e,"catgame.Node")}(catgame||(catgame={}));var catgame;!function(t){var e=function(t){function e(){t.call(this),this.isWeizhu=!1;var i=RES.getRes("bing_json"),s=RES.getRes("bing_png"),a=new egret.MovieClipDataFactory(i,s);e.standmc=new egret.MovieClip(a.generateMovieClipData("stay")),e.standmc.gotoAndPlay("staydrun",-1);var a=new egret.MovieClipDataFactory(i,s);e.weizhumc=new egret.MovieClip(a.generateMovieClipData("weizhu")),e.weizhumc.gotoAndPlay("weizhurun",-1),this.stay()}__extends(e,t);var i=(__define,e),s=i.prototype;return s.init=function(){this.isWeizhu=!1,this.stay()},s.run=function(t){this.x=t[0],this.y=t[1],this.dispatchEventWith("catRun")},s.stay=function(){this.numChildren&&this.removeChildAt(0),this.isWeizhu?(this.addChild(e.weizhumc),e.weizhumc.gotoAndPlay("weizhurun",-1)):(this.addChild(e.standmc),e.standmc.gotoAndPlay("staydrun",-1))},s.weizhu=function(){this.isWeizhu=!0,this.stay()},s.successShow=function(){},s.failShow=function(){},e}(egret.Sprite);t.Cat=e,egret.registerClass(e,"catgame.Cat")}(catgame||(catgame={}));var catgame;!function(t){var e=function(e){function i(){e.call(this);var i=t.createBitmapByName("failed_png");this.tap_textfeild=new egret.TextField,this.tap_textfeild.width=400,this.tap_textfeild.textColor=16711680,this.tap_textfeild.textAlign=egret.HorizontalAlign.CENTER,this.tap_textfeild.text="你没有抓住神！经！猫！！",this.tap_textfeild.size=22,this.tap_textfeild.x=20,this.tap_textfeild.y=190,this.rank_textfeild=new egret.TextField,this.rank_textfeild.width=400,this.rank_textfeild.textColor=16777215,this.rank_textfeild.textAlign=egret.HorizontalAlign.CENTER,this.rank_textfeild.text="精神病院长又发神经病了！",this.rank_textfeild.size=22,this.rank_textfeild.strokeColor=0,this.rank_textfeild.stroke=2,this.rank_textfeild.x=20,this.rank_textfeild.y=230,this.share_btn=t.createBitmapByName("shareBTN_png"),this.share_btn.x=10,this.share_btn.y=i.height+20,this.share_btn.touchEnabled=!0,this.share_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.doShare,this),this.replay_btn=t.createBitmapByName("replay_png"),this.replay_btn.x=220,this.replay_btn.y=i.height+20,this.replay_btn.touchEnabled=!0,this.replay_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.doRepaly,this),this.mao2_btn=t.createBitmapByName("mao2_png"),this.mao2_btn.x=90,this.mao2_btn.y=i.height-80,this.addChild(i),this.addChild(this.tap_textfeild),this.addChild(this.rank_textfeild),this.addChild(this.share_btn),this.addChild(this.replay_btn)}__extends(i,e);var s=(__define,i),a=s.prototype;return a.score=function(t){this.tap_textfeild.text="您用"+t+"步都没有抓住神经猫"},a.doShare=function(t){this.dispatchEventWith("shareEvent")},a.doRepaly=function(t){this.dispatchEventWith("replayEvent")},a.doJump=function(t){},i}(egret.Sprite);t.FailPanel=e,egret.registerClass(e,"catgame.FailPanel")}(catgame||(catgame={}));var catgame;!function(t){var e=function(t){function e(){t.call(this);var e=this.graphics;e.beginFill(0,.8),e.drawRect(0,0,400,200),e.endFill(),this.txt=new egret.TextField,this.txt.width=400,this.txt.height=200,this.txt.textAlign="center",this.txt.textColor=16777215,this.txt.size=24,this.txt.y=60,this.addChild(this.txt)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.showScore=function(t){var e=t+"\n再来一次吧";this.txt.text=e},e}(egret.Sprite);t.ScorePanel=e,egret.registerClass(e,"catgame.ScorePanel")}(catgame||(catgame={}));var catgame;!function(t){var e=function(e){function i(){e.call(this),this.titles_arr=["塞外高手","神精病博士","神经大神","你是我的小苹果","院长派来的救兵","精神病院长","扫地僧","传说中的高手","风骚的少年","白天睡觉喵","隔壁王伯伯"],this.titles2_arr=["神经大条","我是处女座的","停不下来","你是我的小苹果","喵了个咪的","M78星人","凤姐夫","笑而不语"];var i=t.createBitmapByName("victory_png");this.tap_textfeild=new egret.TextField,this.tap_textfeild.width=400,this.tap_textfeild.textColor=16711680,this.tap_textfeild.textAlign=egret.HorizontalAlign.CENTER,this.tap_textfeild.text="您用13步抓住了神经猫",this.tap_textfeild.size=22,this.tap_textfeild.x=20,this.tap_textfeild.y=140,this.rank_textfeild=new egret.TextField,this.rank_textfeild.width=400,this.rank_textfeild.textColor=16777215,this.rank_textfeild.textAlign=egret.HorizontalAlign.CENTER,this.rank_textfeild.text="神经全国排名421位",this.rank_textfeild.size=22,this.rank_textfeild.strokeColor=0,this.rank_textfeild.stroke=2,this.rank_textfeild.x=20,this.rank_textfeild.y=170,this.beat_textfeild=new egret.TextField,this.beat_textfeild.width=400,this.beat_textfeild.textColor=16711680,this.beat_textfeild.textAlign=egret.HorizontalAlign.CENTER,this.beat_textfeild.size=22,this.beat_textfeild.text="击败了精神病院80%的精神病患者",this.beat_textfeild.x=20,this.beat_textfeild.y=200,this.title_textfeild=new egret.TextField,this.title_textfeild.width=400,this.title_textfeild.textColor=16711680,this.title_textfeild.textAlign=egret.HorizontalAlign.CENTER,this.title_textfeild.size=24,this.title_textfeild.text="获得称号：思维广",this.title_textfeild.x=20,this.title_textfeild.y=230,this.share_btn=t.createBitmapByName("shareBTN_png"),this.share_btn.x=10,this.share_btn.y=i.height+20,this.share_btn.touchEnabled=!0,this.share_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.doShare,this),this.replay_btn=t.createBitmapByName("replay_png"),this.replay_btn.x=220,this.replay_btn.y=i.height+20,this.replay_btn.touchEnabled=!0,this.replay_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.doRepaly,this),this.mao2_btn=t.createBitmapByName("mao2_png"),this.mao2_btn.x=90,this.mao2_btn.y=i.height-80,this.mao2_btn.touchEnabled=!0,this.mao2_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.doJump,this),this.addChild(i),this.addChild(this.tap_textfeild),this.addChild(this.rank_textfeild),this.addChild(this.beat_textfeild),this.addChild(this.title_textfeild),this.addChild(this.share_btn),this.addChild(this.replay_btn)}__extends(i,e);var s=(__define,i),a=s.prototype;return a.score=function(t){this.tap_textfeild.text="您用"+t+"步抓住了神经猫",this.rank_textfeild.text="神经全国排名"+Math.floor(1234678*t+Math.random()*t*500)+"位",this.beat_textfeild.text="击败了精神病院"+(100-Math.floor(t*Math.random()))+"%的精神病患者";var e;e=11>t?this.titles_arr[t]:this.titles2_arr[Math.floor(Math.random()*this.titles2_arr.length)],this.title_textfeild.text="获得称号："+e},a.doShare=function(t){this.dispatchEventWith("shareEvent")},a.doRepaly=function(t){this.dispatchEventWith("replayEvent")},a.doJump=function(t){},i}(egret.Sprite);t.SuccessPanel=e,egret.registerClass(e,"catgame.SuccessPanel")}(catgame||(catgame={}));